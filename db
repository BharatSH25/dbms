select m.name as 'musician',s.title as 'song Title',a.name as 'album name' from musician m,album a, song s, perform p where p.ssn=m.ssn and a.aid=s.aid and s.sid=p.sid;


select m.name from musician m where m.ssn not in(select ssn from album);


select s.* from song s,perform p where s.sid=p.sid group by p.sid having count(p.sid)>2;


select count(p.iid),i.name,count(p.iid)/(select count(*) from musician) from play p,instrument
 i where p.iid=i.iid group by p.iid ;
 
 
 
select a.name from album a ,play p,instrument i,musician m where song>(select avg(song) from album ) and p.ssn=m.ssn and p.iid=i.iid and p.ssn in(select ssn from album where i.name in ('flute','guitar'));




 select m.* from musician m where m.ssn in(select p.ssn from play p group by p.ssn having count(p.iid)=(select count(i.iid) from instrument i));









select p.* from patient p,doctor d,treat t where d.dssn=t.dssn and p.ssn=t.ssn and d.speciality='opthamologist' and p.age=22;

select d.* from doctor d,prescribe p where p.dssn=d.dssn and p.pdate=2016 group by p.dssn having count(p.ssn)>1;

 select * from doctor where exp=(select max(exp) from doctor);

select c.* from pharmacy p,contract ct,company c where p.pname=ct.pname and ct.cname=c.cname and c.adress=p.adress group by ct.cname having count(ct.cname)>1;

select D.* from DRUG D,PHCOMPANY P where P.CName=D.CName group by(D.Tradename) having count(D.CName)=1;

 select d.* from drug d,sell s,pharmacy p where s.dname=d.dname and p.pname=s.pname group by s.
dname having count(s.pname)=(select count(*) from pharmacy);







select d.* ,count(d.tin) from distributor d,install i where d.tin=i.tin and itype='domestic' group by d.tin order by max(d.tin);

select u.address from user u,install i,solarpanel s where i.pv_module=s.pv_module and i.house_no=u.house_no and s.capacity=(select max(capacity) from solarpanel);


select u.address from user u,solarpanel p,install i where i.pv_module=p.pv_module and i.house_no=u.house_no and p.pv_type="monocrystalline";

select u.address,sum(i.charge) as "Total charges" from install i,solarpanel p,user u where i.pv_module=p.pv_module and u.house_no=i.house_no and p.pv_type="polycrystalline" and exists(select u.address from user u,install i,solarpanel p where i.pv_module=p.pv_module and u.house_no=i.house_no and
p.pv_type="monocrystalline") group by u.address;


select p.*,d.*,i.idate from install i,distributor d,solarpanel p where p.pv_module=i.pv_module and i.tin=d.tin and i.idate=(select min(idate) from install);

select count(s.pv_module) as "Total sales", count(s.pv_module)/(select count(*) from sell)as "
Avg sales",p.pv_type from solarpanel p,install i,user u,sell s where i.pv_module=p.pv_module and i.house_no=u.house_no and s.pv_module=p.pv_module and i.itype="commercial" group by p.pv_type;





